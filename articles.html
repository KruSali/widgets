<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr. Vocab - The Article Academy (ฉบับละเอียด)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Thai:wght@400;500;600;700&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'IBM Plex Sans Thai', sans-serif;
            background: linear-gradient(to top, #accbee 0%, #e7f0fd 100%);
        }
        .font-poppins {
            font-family: 'Poppins', sans-serif;
        }
        .main-tab {
            transition: all 0.3s ease;
        }
        .main-tab.active {
            background-color: #0369a1; /* sky-700 */
            color: white;
        }
        .rule-card {
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border-left-width: 8px;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .quiz-choice-btn {
            transition: all 0.2s ease-in-out;
        }
        .quiz-choice-btn.correct {
            background-color: #22c55e;
            color: white;
            transform: scale(1.05);
            border-color: #16a34a;
        }
        .quiz-choice-btn.incorrect {
            background-color: #ef4444;
            color: white;
            border-color: #dc2626;
        }
        .quiz-choice-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        .modal {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .modal.hidden {
            opacity: 0;
            transform: scale(0.95);
            pointer-events: none;
        }
        li > span {
            display: block;
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-6xl">

        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold font-poppins text-sky-800">The Article Academy</h1>
            <p class="text-lg text-sky-700 mt-2">โรงเรียนสอนการใช้ A, An, The (ฉบับละเอียดพิเศษ)</p>
        </header>

        <nav class="flex flex-wrap justify-center bg-sky-200 rounded-full p-1 mb-8 max-w-md mx-auto">
            <button data-target="panel-a-an" class="main-tab active w-1/4 py-2 px-2 rounded-full font-semibold text-sm">A / An</button>
            <button data-target="panel-the" class="main-tab w-1/4 py-2 px-2 rounded-full font-semibold text-sm">The</button>
            <button data-target="panel-zero" class="main-tab w-1/4 py-2 px-2 rounded-full font-semibold text-sm">No Article</button>
            <button data-target="panel-quiz" class="main-tab w-1/4 py-2 px-2 rounded-full font-semibold text-sm">แบบฝึกหัด</button>
        </nav>

        <main>
            <div id="panel-a-an" class="content-panel space-y-6">
                <div class="rule-card border-cyan-500 p-6">
                    <h2 class="text-2xl font-bold font-poppins text-cyan-800 mb-3">หลักการใช้ A / An (Indefinite Articles)</h2>
                    <p class="text-slate-700">ใช้กับคำนามนับได้เอกพจน์ (singular countable noun) ที่ **ไม่ชี้เฉพาะเจาะจง** หรือ **กล่าวถึงครั้งแรก** โดยหัวใจสำคัญคือการดู **"เสียง"** แรกของคำที่ตามมา ไม่ใช่ "รูปตัวอักษร"</p>
                </div>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="rule-card border-sky-500 p-6">
                        <h3 class="text-xl font-bold text-sky-800 mb-3">การใช้ "A" + เสียงพยัญชนะ</h3>
                        <p class="text-slate-700 mb-4">ใช้นำหน้าคำที่ขึ้นต้นด้วย **เสียงพยัญชนะ** (Consonant Sound)</p>
                        <ul class="list-disc list-inside space-y-2 text-slate-600">
                            <li>a <strong>c</strong>at (เสียง /k/)</li>
                            <li>a <strong>d</strong>og (เสียง /d/)</li>
                            <li class="font-bold bg-sky-100 p-2 rounded-md">a <strong>u</strong>niversity (เสียง /j/ หรือ ย.ยักษ์)</li>
                            <li class="font-bold bg-sky-100 p-2 rounded-md">a <strong>E</strong>uropean (เสียง /j/ หรือ ย.ยักษ์)</li>
                        </ul>
                    </div>
                    <div class="rule-card border-sky-500 p-6">
                        <h3 class="text-xl font-bold text-sky-800 mb-3">การใช้ "An" + เสียงสระ</h3>
                        <p class="text-slate-700 mb-4">ใช้นำหน้าคำที่ขึ้นต้นด้วย **เสียงสระ** (Vowel Sound: a, e, i, o, u)</p>
                        <ul class="list-disc list-inside space-y-2 text-slate-600">
                            <li>an <strong>a</strong>pple (เสียง /æ/)</li>
                            <li>an <strong>e</strong>lephant (เสียง /e/)</li>
                            <li class="font-bold bg-sky-100 p-2 rounded-md">an <strong>h</strong>our (h ไม่ออกเสียง เริ่มด้วยเสียง /aʊ/ อ.อ่าง)</li>
                             <li class="font-bold bg-sky-100 p-2 rounded-md">an <strong>M</strong>BA (M ออกเสียงว่า 'เอ็ม' ขึ้นด้วยเสียง /e/)</li>
                        </ul>
                    </div>
                </div>
                 <div class="rule-card border-cyan-500 p-6">
                    <h2 class="text-xl font-bold font-poppins text-cyan-800 mb-3">การใช้งานในกรณีอื่นๆ</h2>
                    <ul class="list-disc list-inside space-y-3 mt-4 text-slate-700">
                        <li><strong>ใช้นำหน้าอาชีพ:</strong><br><span class="text-slate-500 ml-4">She is <strong>a doctor</strong>. He wants to be <strong>an engineer</strong>.</span></li>
                        <li><strong>ใช้ในสำนวนบอกปริมาณ/ความถี่:</strong><br><span class="text-slate-500 ml-4"><strong>a dozen</strong> eggs, <strong>a couple</strong> of days, once <strong>a week</strong></span></li>
                        <li><strong>ใช้ในประโยคอุทาน (Exclamation):</strong><br><span class="text-slate-500 ml-4">What <strong>a lovely</strong> day! / Such <strong>a pity</strong>!</span></li>
                    </ul>
                </div>
            </div>

            <div id="panel-the" class="content-panel hidden space-y-6">
                 <div class="rule-card border-indigo-500 p-6">
                    <h2 class="text-2xl font-bold font-poppins text-indigo-800 mb-3">หลักการใช้ The (Definite Article)</h2>
                    <p class="text-slate-700">ใช้กับคำนามที่ **ชี้เฉพาะเจาะจง** ซึ่งทั้งผู้พูดและผู้ฟังเข้าใจตรงกันว่าหมายถึงสิ่งไหน หรือเป็นที่รู้จักกันดีอยู่แล้ว</p>
                    <ul class="list-disc list-inside space-y-3 mt-4 text-slate-700">
                        <li><strong>กล่าวถึงเป็นครั้งที่ 2:</strong><br><span class="text-slate-500 ml-4">I saw <strong>a</strong> dog. <strong>The</strong> dog was barking loudly.</span></li>
                        <li><strong>มีสิ่งเดียวในโลก หรือในบริบทนั้น:</strong><br><span class="text-slate-500 ml-4"><strong>The</strong> Sun, <strong>the</strong> Moon, <strong>the</strong> internet, <strong>the</strong> CEO of this company</span></li>
                        <li><strong>ขั้นสูงสุด (Superlatives):</strong><br><span class="text-slate-500 ml-4">This is <strong>the</strong> best coffee I've ever had.</span></li>
                        <li><strong>เครื่องดนตรี (เมื่อพูดถึงการเล่น):</strong><br><span class="text-slate-500 ml-4">She plays <strong>the</strong> piano beautifully.</span></li>
                        <li><strong>กลุ่มคนในสังคม หรือคนสัญชาติ:</strong><br><span class="text-slate-500 ml-4"><strong>The</strong> rich should help <strong>the</strong> poor. / <strong>The</strong> French are known for their cuisine.</span></li>
                        <li><strong>ชื่อเฉพาะบางประเภท:</strong><br><span class="text-slate-500 ml-4">ชื่อครอบครัว (<strong>the</strong> Simpsons), ทศวรรษ (<strong>the</strong> 1980s), หนังสือพิมพ์ (<strong>the</strong> Guardian), โรงแรม/พิพิธภัณฑ์ (<strong>the</strong> Hilton, <strong>the</strong> Louvre)</span></li>
                    </ul>
                </div>
                 <div class="rule-card border-indigo-500 p-6">
                    <h2 class="text-xl font-bold font-poppins text-indigo-800 mb-3">การใช้ The กับชื่อทางภูมิศาสตร์</h2>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <p class="font-semibold text-green-700">ใช้ The:</p>
                            <ul class="list-disc list-inside space-y-1 text-slate-600">
                                <li>มหาสมุทร: <strong>the</strong> Pacific Ocean</li>
                                <li>แม่น้ำ: <strong>the</strong> Chao Phraya River</li>
                                <li>ทะเลทราย: <strong>the</strong> Sahara</li>
                                <li>กลุ่มเกาะ: <strong>the</strong> Philippines</li>
                                <li>เทือกเขา: <strong>the</strong> Alps</li>
                            </ul>
                        </div>
                         <div>
                            <p class="font-semibold text-red-700">ไม่ใช้ The:</p>
                            <ul class="list-disc list-inside space-y-1 text-slate-600">
                                <li>ทวีป: Asia, Europe</li>
                                <li>ประเทศส่วนใหญ่: Thailand</li>
                                <li>เมือง: Bangkok, London</li>
                                <li>เกาะเดี่ยว: Phuket</li>
                                <li>ภูเขาเดี่ยว: Mount Everest</li>
                                <li>ทะเลสาบ: Lake Superior</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div id="panel-zero" class="content-panel hidden space-y-6">
                 <div class="rule-card border-teal-500 p-6">
                    <h2 class="text-2xl font-bold font-poppins text-teal-800 mb-3">เมื่อไหร่ที่ไม่ต้องใช้ Article (Zero Article)</h2>
                    <p class="text-slate-700">มีหลายกรณีที่เราจะไม่ใช้ a, an, หรือ the นำหน้าคำนาม โดยเฉพาะเมื่อพูดถึงสิ่งต่างๆ ในความหมายกว้างๆ ทั่วไป</p>
                    <ul class="list-disc list-inside space-y-3 mt-4 text-slate-700">
                        <li><strong>นามพหูพจน์ หรือ นามนับไม่ได้ (ที่พูดแบบทั่วไป):</strong><br><span class="text-slate-500 ml-4">I believe <strong>education</strong> is important. / <strong>Tigers</strong> are dangerous animals.</span></li>
                        <li><strong>ชื่อเฉพาะส่วนใหญ่:</strong><br><span class="text-slate-500 ml-4">ชื่อคน (<strong>John</strong>), ชื่อบริษัท (<strong>Microsoft</strong>), ชื่อประเทศส่วนใหญ่ (<strong>Japan</strong>), เมือง (<strong>Paris</strong>)</span></li>
                        <li><strong>มื้ออาหาร, วัน, เดือน, เทศกาล:</strong><br><span class="text-slate-500 ml-4">I have <strong>breakfast</strong> at 8. / See you on <strong>Monday</strong>. / I was born in <strong>April</strong>.</span></li>
                        <li><strong>ภาษา, กีฬา, และวิชาเรียน:</strong><br><span class="text-slate-500 ml-4">She speaks <strong>Japanese</strong>. / He plays <strong>football</strong>. / I'm studying <strong>history</strong>.</span></li>
                         <li><strong>การเดินทาง (พูดถึงวิธีโดยรวม):</strong><br><span class="text-slate-500 ml-4">I go to work <strong>by train</strong>. (แต่ถ้าจะระบุเจาะจง: I took <strong>the</strong> 8:30 train.)</span></li>
                        <li><strong>สถาบัน (เมื่อพูดถึงจุดประสงค์หลัก):</strong><br><span class="text-slate-500 ml-4">Children go to <strong>school</strong>. / He is in <strong>hospital</strong>. (แต่ถ้าไปเยี่ยม: I went to <strong>the</strong> hospital to see him.)</span></li>
                    </ul>
                </div>
            </div>

            <div id="panel-quiz" class="content-panel hidden">
                 <div id="quiz-container" class="bg-white/70 backdrop-blur-sm rounded-2xl shadow-lg p-6 md:p-8 text-center max-w-2xl mx-auto">
                    <div id="quiz-start">
                        <h2 class="text-2xl font-bold text-slate-700 mb-4">มาทดสอบความเข้าใจกัน!</h2>
                        <button id="start-quiz-btn" class="bg-sky-600 text-white font-bold py-3 px-8 rounded-full hover:bg-sky-700 transition transform hover:scale-105">เริ่มเลย!</button>
                    </div>
                    <div id="quiz-main" class="hidden">
                        <p id="quiz-progress" class="text-sm text-slate-500 mb-2"></p>
                        <div class="bg-slate-100 p-6 rounded-lg mb-6"><h2 class="text-2xl md:text-3xl font-semibold text-slate-800" id="question-sentence"></h2></div>
                        <div id="choices-container" class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
                            <button data-choice="a" class="quiz-choice-btn border-2 border-slate-400 text-slate-600 font-bold py-3 rounded-lg text-xl hover:bg-slate-500 hover:text-white">a</button>
                            <button data-choice="an" class="quiz-choice-btn border-2 border-slate-400 text-slate-600 font-bold py-3 rounded-lg text-xl hover:bg-slate-500 hover:text-white">an</button>
                            <button data-choice="the" class="quiz-choice-btn border-2 border-slate-400 text-slate-600 font-bold py-3 rounded-lg text-xl hover:bg-slate-500 hover:text-white">the</button>
                            <button data-choice="no_article" class="quiz-choice-btn border-2 border-slate-400 text-slate-600 font-bold py-3 rounded-lg text-xl hover:bg-slate-500 hover:text-white">-- <small>(no article)</small></button>
                        </div>
                        <p id="feedback" class="h-6 text-lg font-bold mb-4"></p>
                        <div class="flex justify-center items-center gap-4">
                            <button id="show-explanation-btn" class="bg-gray-200 text-gray-700 font-bold py-2 px-6 rounded-full hover:bg-gray-300 transition hidden">ดูคำอธิบาย</button>
                            <button id="next-question-btn" class="bg-sky-600 text-white font-bold py-2 px-6 rounded-full hover:bg-sky-700 transition hidden">ข้อถัดไป</button>
                        </div>
                    </div>
                    <div id="quiz-end" class="hidden">
                        <h2 class="text-2xl font-bold text-slate-700 mb-4">ทำแบบทดสอบเสร็จแล้ว!</h2>
                        <p id="final-score" class="text-6xl font-bold font-poppins text-sky-800 mb-6"></p>
                        <p id="score-message" class="text-lg mb-6"></p>
                        <button id="restart-quiz-btn" class="bg-sky-600 text-white font-bold py-3 px-8 rounded-full hover:bg-sky-700 transition transform hover:scale-105">ทำอีกครั้ง</button>
                    </div>
                 </div>
            </div>
        </main>
    </div>

    <div id="explanation-modal" class="modal fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center p-4 z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md mx-auto overflow-hidden transform">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold font-poppins text-sky-800">คำอธิบายเพิ่มเติม</h2>
                    <button id="explanation-close-btn" class="text-gray-400 hover:text-gray-700 transition text-3xl leading-none">&times;</button>
                </div>
                <div id="explanation-content" class="text-slate-700 space-y-3">
                    <p><strong>ประโยค:</strong> <span id="explanation-q-sentence" class="font-mono"></span></p>
                    <p><strong>คำตอบที่ถูกคือ:</strong> <span id="explanation-correct-answer" class="font-bold font-mono bg-green-100 text-green-800 py-1 px-2 rounded"></span></p>
                    <p id="explanation-text"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Tab Switching Logic ---
            const tabs = document.querySelectorAll('.main-tab');
            const panels = document.querySelectorAll('.content-panel');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    panels.forEach(p => p.classList.add('hidden'));
                    tab.classList.add('active');
                    document.getElementById(tab.dataset.target).classList.remove('hidden');
                });
            });

            // --- Quiz Logic ---
            const quizQuestions = [
                { question: "She is ___ amazing singer.", answer: "an", explanation: "คำว่า 'amazing' ขึ้นต้นด้วยเสียงสระ /ə/ (อะ) จึงต้องใช้ an ครับ" },
                { question: "I need to buy ___ new car.", answer: "a", explanation: "เรากล่าวถึง 'รถคันใหม่' เป็นครั้งแรก และเป็นสิ่งที่ไม่เฉพาะเจาะจง จึงใช้ a ที่นำหน้าเสียงพยัญชนะ /n/ ครับ" },
                { question: "Could you pass me ___ salt, please?", answer: "the", explanation: "เราใช้ the เพราะผู้พูดและผู้ฟังเข้าใจตรงกันว่าหมายถึง 'เกลือ' ขวด/กระปุกที่อยู่ตรงหน้านั้น เป็นการชี้เฉพาะเจาะจงครับ" },
                { question: "He is studying at ___ university in London.", answer: "a", explanation: "คำว่า 'university' ขึ้นต้นด้วยสระ 'u' แต่กลับออกเสียงเป็น /j/ (เสียง ย) ซึ่งเป็นเสียงพยัญชนะ ดังนั้นจึงต้องใช้ a ครับ" },
                { question: "My appointment is in ___ hour.", answer: "an", explanation: "คำว่า 'hour' ขึ้นต้นด้วยพยัญชนะ 'h' แต่ตัว 'h' ไม่ออกเสียง (silent h) ทำให้เสียงแรกของคำเป็นเสียงสระ /aʊ/ (อาว) ดังนั้นจึงต้องใช้ an ครับ" },
                { question: "I love listening to ___ music.", answer: "no_article", explanation: "เราไม่ใช้ Article กับคำนามนับไม่ได้ (music) เมื่อพูดถึงสิ่งนั้นในความหมายกว้างๆ ทั่วไป ไม่ได้ชี้เฉพาะเจาะจงครับ" },
                { question: "___ sun is very bright today.", answer: "the", explanation: "เราใช้ the กับสิ่งที่มีเพียงสิ่งเดียวในโลกโดยธรรมชาติ เช่น The Sun (ดวงอาทิตย์), The Moon (ดวงจันทร์) ครับ" },
                { question: "She wants to be ___ engineer.", answer: "an", explanation: "คำว่า 'engineer' ขึ้นต้นด้วยเสียงสระ /e/ (เอ็น) และเป็นการกล่าวถึงอาชีพ จึงต้องใช้ an ครับ" },
                { question: "We bought ___ house. ___ house is very old.", answer: "a", explanation: "ในช่องว่างแรก เรากล่าวถึง 'บ้าน' เป็นครั้งแรก จึงใช้ a แต่เมื่อกล่าวถึงบ้านหลังเดิมอีกครั้งในประโยคถัดไป จะกลายเป็นการชี้เฉพาะเจาะจงและต้องใช้ the ครับ" },
                { question: "He plays ___ basketball after school.", answer: "no_article", explanation: "โดยทั่วไปแล้ว เราจะไม่ใช้ Article นำหน้าชื่อกีฬา เช่น play football, play tennis, play basketball ครับ" }
            ];

            let shuffledQuestions = [];
            let currentQuestionIndex = 0;
            let score = 0;

            const quizStart = document.getElementById('quiz-start');
            const quizMain = document.getElementById('quiz-main');
            const quizEnd = document.getElementById('quiz-end');
            const startQuizBtn = document.getElementById('start-quiz-btn');
            const restartQuizBtn = document.getElementById('restart-quiz-btn');
            const nextQuestionBtn = document.getElementById('next-question-btn');
            const questionSentence = document.getElementById('question-sentence');
            const choiceBtns = document.querySelectorAll('.quiz-choice-btn');
            const quizProgress = document.getElementById('quiz-progress');
            const feedback = document.getElementById('feedback');
            const finalScore = document.getElementById('final-score');
            const scoreMessage = document.getElementById('score-message');
            const showExplanationBtn = document.getElementById('show-explanation-btn');
            const explanationModal = document.getElementById('explanation-modal');
            const explanationCloseBtn = document.getElementById('explanation-close-btn');
            const explanationQSentence = document.getElementById('explanation-q-sentence');
            const explanationCorrectAnswer = document.getElementById('explanation-correct-answer');
            const explanationText = document.getElementById('explanation-text');

            function startQuiz() {
                shuffledQuestions = [...quizQuestions].sort(() => Math.random() - 0.5);
                currentQuestionIndex = 0;
                score = 0;
                quizStart.classList.add('hidden');
                quizEnd.classList.add('hidden');
                quizMain.classList.remove('hidden');
                nextQuestionBtn.classList.add('hidden');
                showQuestion();
            }

            function showQuestion() {
                resetState();
                const question = shuffledQuestions[currentQuestionIndex];
                questionSentence.innerHTML = question.question.replace('___', '<span class="font-bold text-sky-600">___</span>');
                quizProgress.textContent = `คำถามที่ ${currentQuestionIndex + 1}/${shuffledQuestions.length}`;
            }
            
            function resetState() {
                choiceBtns.forEach(btn => {
                    btn.classList.remove('correct', 'incorrect');
                    btn.disabled = false;
                });
                feedback.textContent = '';
                nextQuestionBtn.classList.add('hidden');
                showExplanationBtn.classList.add('hidden');
            }

            function selectAnswer(e) {
                const selectedChoice = e.target.dataset.choice;
                const correct = selectedChoice === shuffledQuestions[currentQuestionIndex].answer;
                
                if(correct) {
                    score++;
                    feedback.textContent = 'ถูกต้อง!';
                    feedback.className = 'h-6 text-lg font-bold mb-4 text-green-600';
                    e.target.classList.add('correct');
                } else {
                    feedback.textContent = 'ยังไม่ถูกนะ!';
                    feedback.className = 'h-6 text-lg font-bold mb-4 text-red-600';
                    e.target.classList.add('incorrect');
                    const correctBtn = Array.from(choiceBtns).find(btn => btn.dataset.choice === shuffledQuestions[currentQuestionIndex].answer);
                    correctBtn.classList.add('correct');
                    showExplanationBtn.classList.remove('hidden');
                }
                
                choiceBtns.forEach(btn => btn.disabled = true);
                
                if (currentQuestionIndex < shuffledQuestions.length - 1) {
                    nextQuestionBtn.textContent = 'ข้อถัดไป';
                } else {
                    nextQuestionBtn.textContent = 'ดูผลคะแนน';
                }
                nextQuestionBtn.classList.remove('hidden');
            }

            function handleNextQuestion() {
                currentQuestionIndex++;
                if (currentQuestionIndex < shuffledQuestions.length) {
                    showQuestion();
                } else {
                    showEndScreen();
                }
            }
            
            function showEndScreen() {
                quizMain.classList.add('hidden');
                quizEnd.classList.remove('hidden');
                finalScore.textContent = `${score} / ${shuffledQuestions.length}`;
                
                let message = '';
                const percentage = (score / shuffledQuestions.length) * 100;
                if (percentage === 100) message = 'ยอดเยี่ยม! คุณคือเจ้าแห่ง Articles!';
                else if (percentage >= 80) message = 'เก่งมาก! เข้าใจหลักการได้ดีเยี่ยม!';
                else if (percentage >= 50) message = 'ทำได้ดี! ทบทวนอีกนิดหน่อยก็สมบูรณ์แบบแล้ว!';
                else message = 'สู้ๆ นะ! ลองทบทวนในหน้าบทเรียนแล้วมาลองใหม่กัน!';
                scoreMessage.textContent = message;
            }

            function openExplanation() {
                const question = shuffledQuestions[currentQuestionIndex];
                explanationQSentence.innerHTML = question.question.replace('___', '<span class="font-bold text-sky-600">___</span>');
                let correctAnswerText = question.answer;
                if (question.answer === 'no_article') {
                    correctAnswerText = '-- (no article)';
                }
                explanationCorrectAnswer.textContent = correctAnswerText;
                explanationText.textContent = question.explanation;
                explanationModal.classList.remove('hidden');
            }

            function closeExplanation() {
                explanationModal.classList.add('hidden');
            }
            
            startQuizBtn.addEventListener('click', startQuiz);
            restartQuizBtn.addEventListener('click', startQuiz);
            nextQuestionBtn.addEventListener('click', handleNextQuestion);
            choiceBtns.forEach(btn => btn.addEventListener('click', selectAnswer));
            showExplanationBtn.addEventListener('click', openExplanation);
            explanationCloseBtn.addEventListener('click', closeExplanation);
            explanationModal.addEventListener('click', (e) => { if(e.target.id === 'explanation-modal') closeExplanation(); });
        });
    </script>

</body>
</html>